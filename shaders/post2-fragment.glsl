#version 330 core

in vec2 fPos;

out vec4 fColor;

uniform sampler2D uTexture;
uniform vec2 uBlur;
uniform vec3 uColorMul;

vec4 t(float x, float y) {
    return texture(uTexture, fPos+vec2(x, y)*uBlur);
}

void main() {
    vec4 clr = texture(uTexture, fPos);

    vec4 blur = uBlur.x > 0.0 ?
        (t(-3.,-2.)*.19+t(-3.,-1.)*.38+t(-3.,0.)*.44+t(-3.,1.)*.38+t(-3.,2.)*.19+t(-2.,-3.)*.19+t(-2.,-2.)*.50+t(-2.,-1.)*.69+t(-2.,0.)*.75+t(-2.,1.)*.69+t(-2.,2.)*.50+t(-2.,3.)*.19+t(-1.,-3.)*.38+t(-1.,-2.)*.69+t(-1.,-1.)*.88+t(-1.,0.)*.94+t(-1.,1.)*.88+t(-1.,2.)*.69+t(-1.,3.)*.38+t(0.,-3.)*.44+t(0.,-2.)*.75+t(0.,-1.)*.94+t(0.,1.)*.94+t(0.,2.)*.75+t(0.,3.)*.44+t(1.,-3.)*.38+t(1.,-2.)*.69+t(1.,-1.)*.88+t(1.,0.)*.94+t(1.,1.)*.88+t(1.,2.)*.69+t(1.,3.)*.38+t(2.,-3.)*.19+t(2.,-2.)*.50+t(2.,-1.)*.69+t(2.,0.)*.75+t(2.,1.)*.69+t(2.,2.)*.50+t(2.,3.)*.19+t(3.,-2.)*.19+t(3.,-1.)*.38+t(3.,0.)*.44+t(3.,1.)*.38+t(3.,2.)*.19)/24.12
        : clr;
    
    fColor = vec4((clr.rgb+blur.rgb)/2.0*uColorMul, 1.0);
}